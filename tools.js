const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/client-processor-SJcInaeg.js","assets/vendor-C_Uzxf6_.js"])))=>i.map(i=>d[i]);
import"./assets/modulepreload-polyfill-B5Qt9EMX.js";const A="modulepreload",T=function(t){return"/webp-jpeg-www/"+t},k={},U=function(e,o,d){let m=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));m=Promise.allSettled(o.map(n=>{if(n=T(n),n in k)return;k[n]=!0;const p=n.endsWith(".css"),$=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${$}`))return;const f=document.createElement("link");if(f.rel=p?"stylesheet":A,p||(f.as="script"),f.crossOrigin="",f.href=n,l&&f.setAttribute("nonce",l),document.head.appendChild(f),p)return new Promise((D,R)=>{f.addEventListener("load",D),f.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${n}`)))})}))}function i(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return m.then(r=>{for(const l of r||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};let a=[],u,g,v,b,w,h,y,C,s,S,L,z;document.addEventListener("DOMContentLoaded",()=>{console.log("DOM Loaded - initializing Tools"),u=document.getElementById("file-dropzone"),g=document.getElementById("file-input"),v=document.getElementById("file-list"),b=document.getElementById("clear-list"),w=document.getElementById("execute-btn"),h=document.getElementById("console-log"),y=document.getElementById("theme-toggle"),C=document.getElementById("processing-mode"),s=document.getElementById("base-name"),S=document.getElementById("start-number"),L=document.getElementById("opt-crop"),z=document.getElementById("opt-resize");const t=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",t),y&&y.addEventListener("click",()=>{const o=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",o),localStorage.setItem("theme",o),c(`Zmiana motywu na: ${o}`)}),u&&g?(u.addEventListener("click",()=>{console.log("Dropzone clicked"),g.click()}),g.addEventListener("change",e=>{B(e.target.files),g.value=""}),u.addEventListener("dragover",e=>{e.preventDefault(),u.style.borderColor="var(--accent-color)"}),u.addEventListener("dragleave",e=>{e.preventDefault(),u.style.borderColor="var(--border-color)"}),u.addEventListener("drop",e=>{e.preventDefault(),u.style.borderColor="var(--border-color)",B(e.dataTransfer.files)})):console.error("Brak elementu dropzone lub fileInput!"),b&&b.addEventListener("click",()=>{a=[],E(),c("Lista wyczyszczona.")}),s&&(s.addEventListener("mouseenter",async()=>{if(s.value.trim()==="")try{const e=await navigator.clipboard.readText();if(e){const o=I(e);o&&(s.value=o,s.classList.add("flash-input"),setTimeout(()=>s.classList.remove("flash-input"),500),c(`Wklejono ze schowka: ${o}`))}}catch{}}),s.addEventListener("input",()=>{const e=s.value,o=I(e);e!==o&&(s.value=o)})),w&&w.addEventListener("click",async()=>{N()})});async function N(){if(a.length===0){c("BŁĄD: Brak plików do przetworzenia.");return}const t=s.value.trim()||"image",e=parseInt(S.value)||1,o=C.value;if(c(`Rozpoczynanie procedury (${o==="local"?"LOKALNIE":"SERWER"})...`),o==="local"){const m={baseName:t,startNumber:e,optCrop:L.checked,optResize:z.checked};try{const{processFilesClientSide:i}=await U(async()=>{const{processFilesClientSide:p}=await import("./assets/client-processor-SJcInaeg.js");return{processFilesClientSide:p}},__vite__mapDeps([0,1])),r=await i(a,m,p=>c(p)),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download="processed.zip",document.body.appendChild(n),n.click(),n.remove(),c("SUKCES: Gotowe (Lokalnie).")}catch(i){c(`BŁĄD LOKALNY: ${i.message}`)}return}const d=new FormData;a.forEach(m=>{d.append("images",m.file)}),d.append("newName",t),d.append("startNumber",e),d.append("optCrop",L.checked),d.append("optResize",z.checked);try{const i=await fetch("http://localhost:3000/upload-tools",{method:"POST",body:d});if(i.ok){c("SUKCES: Pliki przetworzone.");const r=await i.blob(),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download="processed.zip",document.body.appendChild(n),n.click(),n.remove(),c("Rozpoczęto pobieranie archiwum.")}else{const r=await i.text();c(`BŁĄD SERWERA: ${r}`)}}catch(m){c(`BŁĄD SIECI: ${m.message}`)}}function c(t){if(!h)return;const e=document.createElement("p");e.textContent=`> ${t}`,h.appendChild(e),h.scrollTop=h.scrollHeight}const I=t=>{const e={ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ó:"o",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"E",Ł:"L",Ń:"N",Ó:"O",Ś:"S",Ź:"Z",Ż:"Z"};let o=t.replace(/[ąćęłńóśźżĄĆĘŁŃÓŚŹŻ]/g,d=>e[d]);return o=o.replace(/[^a-zA-Z0-9]/g,"-"),o=o.replace(/-+/g,"-"),o=o.replace(/^-+|-+$/g,""),o};function E(){v&&(v.innerHTML="",a.forEach((t,e)=>{const o=document.createElement("li");o.className="file-item",o.innerHTML=`
      <span class="file-info">[${e+1}] ${t.file.name} (${(t.file.size/1024).toFixed(1)} KB)</span>
      <div class="file-controls">
        <button class="btn btn-sm" onclick="window.moveUp(${e})">▲</button>
        <button class="btn btn-sm" onclick="window.moveDown(${e})">▼</button>
        <button class="btn btn-sm" onclick="window.removeFile(${e})" style="color:var(--error-color); border-color:var(--error-color);">X</button>
      </div>
    `,v.appendChild(o)}))}function B(t){Array.from(t).forEach(e=>{e.type.startsWith("image/")?(a.push({file:e,id:Date.now()+Math.random()}),c(`Dodano: ${e.name}`)):c(`BŁĄD: ${e.name} nie jest obrazem.`)}),E()}window.moveUp=t=>{t>0&&([a[t-1],a[t]]=[a[t],a[t-1]],E())};window.moveDown=t=>{t<a.length-1&&([a[t+1],a[t]]=[a[t],a[t+1]],E())};window.removeFile=t=>{c(`Usunięto: ${a[t].file.name}`),a.splice(t,1),E()};
//# sourceMappingURL=tools.js.map
