const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/client-processor-D-td7EAr.js","assets/vendor-C_Uzxf6_.js"])))=>i.map(i=>d[i]);
import"./assets/modulepreload-polyfill-B5Qt9EMX.js";const N="modulepreload",O=function(e){return"/webp-jpeg-www/"+e},$={},F=function(t,n,r){let c=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));c=Promise.allSettled(n.map(u=>{if(u=O(u),u in $)return;$[u]=!0;const a=u.endsWith(".css"),g=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const h=document.createElement("link");if(h.rel=a?"stylesheet":N,a||(h.as="script"),h.crossOrigin="",h.href=u,d&&h.setAttribute("nonce",d),document.head.appendChild(h),a)return new Promise((U,P)=>{h.addEventListener("load",U),h.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return c.then(o=>{for(const d of o||[])d.status==="rejected"&&i(d.reason);return t().catch(i)})};let l=[],p,v,y,b,L,E,k,T,m,D,z,C,I,B;document.addEventListener("DOMContentLoaded",()=>{console.log("DOM Loaded - initializing Tools"),p=document.getElementById("file-dropzone"),v=document.getElementById("file-input"),y=document.getElementById("file-list"),b=document.getElementById("clear-list"),L=document.getElementById("execute-btn"),E=document.getElementById("console-log"),k=document.getElementById("theme-toggle"),T=document.getElementById("processing-mode"),m=document.getElementById("base-name"),D=document.getElementById("start-number"),z=document.getElementById("opt-crop"),C=document.getElementById("opt-trim-only"),I=document.getElementById("opt-add-margin"),B=document.getElementById("opt-resize");const e=localStorage.getItem("theme")||"dark";if(document.documentElement.setAttribute("data-theme",e),k&&k.addEventListener("click",()=>{const n=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n),s(`Zmiana motywu na: ${n}`)}),p&&v?(p.addEventListener("click",()=>{console.log("Dropzone clicked"),v.click()}),v.addEventListener("change",t=>{S(t.target.files),v.value=""}),p.addEventListener("dragover",t=>{t.preventDefault(),p.style.borderColor="var(--accent-color)"}),p.addEventListener("dragleave",t=>{t.preventDefault(),p.style.borderColor="var(--border-color)"}),p.addEventListener("drop",t=>{t.preventDefault(),p.style.borderColor="var(--border-color)",S(t.dataTransfer.files)})):console.error("Brak elementu dropzone lub fileInput!"),b&&b.addEventListener("click",()=>{l=[],w(),s("Lista wyczyszczona.")}),m){const t=async()=>{try{const n=await navigator.clipboard.readText();if(n){const r=R(n);r&&m.value!==r&&(m.value=r,m.classList.add("flash-input"),setTimeout(()=>m.classList.remove("flash-input"),500),s(`Wklejono ze schowka: ${r}`))}}catch{}};m.addEventListener("mouseenter",t),m.addEventListener("click",t),m.addEventListener("focus",t),window.addEventListener("focus",()=>{m.matches(":hover")&&t()}),m.addEventListener("input",()=>{const n=m.value,r=R(n);n!==r&&(m.value=r)})}L&&L.addEventListener("click",async()=>{j()})});function s(e){if(!E)return;const t=document.createElement("p");t.textContent=`> ${e}`,E.appendChild(t),E.scrollTop=E.scrollHeight}const R=e=>{const t={ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ó:"o",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"E",Ł:"L",Ń:"N",Ó:"O",Ś:"S",Ź:"Z",Ż:"Z"};let n=e.replace(/[ąćęłńóśźżĄĆĘŁŃÓŚŹŻ]/g,r=>t[r]);return n=n.replace(/[^a-zA-Z0-9]/g,"-"),n=n.replace(/-+/g,"-"),n=n.replace(/^-+|-+$/g,""),n};function w(){y&&(y.innerHTML="",l.forEach((e,t)=>{const n=document.createElement("li");n.className="file-item";const r=document.createElement("input");r.type="checkbox",r.className="file-select",r.checked=e.selected,r.onchange=o=>{e.selected=o.target.checked};const c=document.createElement("span");c.className="file-info",c.textContent=`[${t+1}] ${e.file.name} (${(e.file.size/1024).toFixed(1)} KB)`,c.addEventListener("mouseenter",o=>_(o,e.file)),c.addEventListener("mouseleave",M),c.addEventListener("mousemove",A);const i=document.createElement("div");i.className="file-controls",i.innerHTML=`
        <button class="btn btn-sm" onclick="window.moveUp(${t})">▲</button>
        <button class="btn btn-sm" onclick="window.moveDown(${t})">▼</button>
        <button class="btn btn-sm" onclick="window.removeFile(${t})" style="color:var(--error-color); border-color:var(--error-color);">X</button>
    `,n.appendChild(r),n.appendChild(c),n.appendChild(i),y.appendChild(n)}))}const f=document.getElementById("preview-tooltip");function _(e,t){if(!f)return;const n=URL.createObjectURL(t);f.innerHTML=`<img src="${n}" alt="Preview">`,f.style.display="block",A(e)}function A(e){if(!f)return;const t=e.clientX+15,n=e.clientY+15;f.style.left=t+"px",f.style.top=n+"px"}function M(){f&&(f.style.display="none",f.innerHTML="")}function S(e){Array.from(e).forEach(t=>{t.type.startsWith("image/")?(l.push({file:t,id:Date.now()+Math.random(),selected:!0}),s(`Dodano: ${t.name}`)):s(`BŁĄD: ${t.name} nie jest obrazem.`)}),w()}window.moveUp=e=>{e>0&&([l[e-1],l[e]]=[l[e],l[e-1]],w())};window.moveDown=e=>{e<l.length-1&&([l[e+1],l[e]]=[l[e],l[e+1]],w())};window.removeFile=e=>{const t=l[e];if(t.selected){const n=l.length;l=l.filter(c=>!c.selected);const r=n-l.length;s(`Usunięto zaznaczone pliki: ${r}`)}else s(`Usunięto: ${t.file.name}`),l.splice(e,1);w()};async function j(){const e=l.filter(i=>i.selected);if(e.length===0){s("BŁĄD: Brak zaznaczonych plików do przetworzenia.");return}const t=m.value.trim()||"image",n=parseInt(D.value)||1,r=T.value;if(s(`Rozpoczynanie procedury dla ${e.length} plików (${r==="local"?"LOKALNIE":"SERWER"})...`),r==="local"){const i={baseName:t,startNumber:n,optCrop:z.checked,optTrimOnly:C.checked,optAddMargin:I.checked,optResize:B.checked};try{const{processFilesClientSide:o}=await F(async()=>{const{processFilesClientSide:g}=await import("./assets/client-processor-D-td7EAr.js");return{processFilesClientSide:g}},__vite__mapDeps([0,1])),d=await o(e,i,g=>s(g)),u=window.URL.createObjectURL(d),a=document.createElement("a");a.href=u,a.download="processed.zip",document.body.appendChild(a),a.click(),a.remove(),s("SUKCES: Gotowe (Lokalnie).")}catch(o){s(`BŁĄD LOKALNY: ${o.message}`)}return}const c=new FormData;e.forEach(i=>{c.append("images",i.file)}),c.append("newName",t),c.append("startNumber",n),c.append("optCrop",z.checked),c.append("optTrimOnly",C.checked),c.append("optAddMargin",I.checked),c.append("optResize",B.checked);try{const o=await fetch("http://localhost:3000/upload-tools",{method:"POST",body:c});if(o.ok){s("SUKCES: Pliki przetworzone.");const d=await o.blob(),u=window.URL.createObjectURL(d),a=document.createElement("a");a.href=u,a.download="processed.zip",document.body.appendChild(a),a.click(),a.remove(),s("Rozpoczęto pobieranie archiwum.")}else{const d=await o.text();s(`BŁĄD SERWERA: ${d}`)}}catch(i){s(`BŁĄD SIECI: ${i.message}`)}}
//# sourceMappingURL=tools.js.map
