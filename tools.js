const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./assets/client-processor-DndueCvx.js","./assets/vendor-529iNPX7.js"])))=>i.map(i=>d[i]);
import"./assets/modulepreload-polyfill-B5Qt9EMX.js";const x="modulepreload",M=function(e,n){return new URL(e,n).href},S={},Z=function(n,t,o){let r=Promise.resolve();if(t&&t.length>0){const a=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),f=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(t.map(d=>{if(d=M(d,o),d in S)return;S[d]=!0;const s=d.endsWith(".css"),g=s?'[rel="stylesheet"]':"";if(!!o)for(let v=a.length-1;v>=0;v--){const L=a[v];if(L.href===d&&(!s||L.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${g}`))return;const u=document.createElement("link");if(u.rel=s?"stylesheet":x,s||(u.as="script"),u.crossOrigin="",u.href=d,f&&u.setAttribute("nonce",f),document.head.appendChild(u),s)return new Promise((v,L)=>{u.addEventListener("load",v),u.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${d}`)))})}))}function p(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return r.then(a=>{for(const l of a||[])l.status==="rejected"&&p(l.reason);return n().catch(p)})};let c=[];const _=(e,n=18)=>{if(e.length<=n)return e;const t=e.split("."),o=t.length>1?`.${t.pop()}`:"",r=t.join("."),p=8,a=6;return r.length<=p?`${r.substring(0,p)}...${o}`:`${r.substring(0,p)}...${r.substring(r.length-a)}${o}`};let h,E,z,$,I,b,B,P,m,R,C,A,N,O,U,F;document.addEventListener("DOMContentLoaded",()=>{console.log("DOM Loaded - initializing Tools"),h=document.getElementById("file-dropzone"),E=document.getElementById("file-input"),z=document.getElementById("file-list"),$=document.getElementById("clear-list"),I=document.getElementById("execute-btn"),b=document.getElementById("console-log"),B=document.getElementById("theme-toggle"),P=document.getElementById("processing-mode"),m=document.getElementById("base-name"),R=document.getElementById("start-number"),O=document.getElementById("mode-smart"),U=document.getElementById("mode-simple"),F=document.getElementById("mode-none"),C=document.getElementById("opt-add-margin"),A=document.getElementById("opt-resize"),N=document.getElementById("opt-overwrite"),window.electronAPI&&(document.body.classList.add("is-electron"),i("Tryb Desktop (Electron) aktywny."));const e=localStorage.getItem("theme")||"dark";if(document.documentElement.setAttribute("data-theme",e),B&&B.addEventListener("click",()=>{const t=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),i(`Zmiana motywu na: ${t}`)}),h&&E?(h.addEventListener("click",()=>{console.log("Dropzone clicked"),E.click()}),E.addEventListener("change",n=>{D(n.target.files),E.value=""}),h.addEventListener("dragover",n=>{n.preventDefault(),h.style.borderColor="var(--accent-color)"}),h.addEventListener("dragleave",n=>{n.preventDefault(),h.style.borderColor="var(--border-color)"}),h.addEventListener("drop",n=>{n.preventDefault(),h.style.borderColor="var(--border-color)",D(n.dataTransfer.files)})):console.error("Brak elementu dropzone lub fileInput!"),$&&$.addEventListener("click",()=>{c=[],k(),i("Lista wyczyszczona.")}),m){const n=async()=>{try{const t=await navigator.clipboard.readText();if(t){const o=T(t);o&&m.value!==o&&(m.value=o,m.classList.add("flash-input"),setTimeout(()=>m.classList.remove("flash-input"),500),i(`Wklejono ze schowka: ${o}`))}}catch{}};m.addEventListener("mouseenter",n),m.addEventListener("focus",n),window.addEventListener("focus",()=>{m.matches(":hover")&&n()}),m.addEventListener("input",()=>{const t=m.value,o=T(t);t!==o&&(m.value=o)})}I&&I.addEventListener("click",async()=>{Y()})});function i(e){if(!b)return;const n=document.createElement("p");n.textContent=`> ${e}`,b.appendChild(n),b.scrollTop=b.scrollHeight}const T=e=>{const n={ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ó:"o",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"E",Ł:"L",Ń:"N",Ó:"O",Ś:"S",Ź:"Z",Ż:"Z"};let t=e.replace(/[ąćęłńóśźżĄĆĘŁŃÓŚŹŻ]/g,o=>n[o]);return t=t.replace(/[^a-zA-Z0-9]/g,"-"),t=t.replace(/-+/g,"-"),t=t.replace(/^-+|-+$/g,""),t};function k(){z&&(z.innerHTML="",c.forEach((e,n)=>{const t=document.createElement("li");t.className="file-item";const o=document.createElement("input");o.type="checkbox",o.className="file-select",o.checked=e.selected,o.onchange=l=>{e.selected=l.target.checked};const r=document.createElement("span");r.className="file-info";const p=_(e.file.name);r.textContent=`[${n+1}] ${p} (${(e.file.size/1024).toFixed(1)} KB) (${e.width}x${e.height} px)`,r.title=e.file.name,r.addEventListener("mouseenter",l=>W(l,e.file)),r.addEventListener("mouseleave",H),r.addEventListener("mousemove",j);const a=document.createElement("div");a.className="file-controls",a.innerHTML=`
        <button class="btn btn-sm" onclick="window.moveUp(${n})">▲</button>
        <button class="btn btn-sm" onclick="window.moveDown(${n})">▼</button>
        <button class="btn btn-sm" onclick="window.removeFile(${n})" style="color:var(--error-color); border-color:var(--error-color);">X</button>
    `,t.appendChild(o),t.appendChild(r),t.appendChild(a),z.appendChild(t)}))}const w=document.getElementById("preview-tooltip");function W(e,n){if(!w)return;const t=URL.createObjectURL(n);w.innerHTML=`<img src="${t}" alt="Preview">`,w.style.display="block",j(e)}function j(e){if(!w)return;const n=e.clientX+15,t=e.clientY+15;w.style.left=n+"px",w.style.top=t+"px"}function H(){w&&(w.style.display="none",w.innerHTML="")}const K=e=>new Promise((n,t)=>{const o=new Image;o.onload=()=>{URL.revokeObjectURL(o.src),n({width:o.width,height:o.height})},o.onerror=t,o.src=URL.createObjectURL(e)});async function D(e){const n=[];for(const t of Array.from(e))if(t.type.startsWith("image/"))try{const{width:o,height:r}=await K(t);n.push({file:t,id:Date.now()+Math.random(),selected:!0,width:o,height:r}),i(`Dodano: ${t.name} (${o}x${r} px)`)}catch(o){i(`BŁĄD podczas wczytywania wymiarów pliku ${t.name}: ${o.message}`)}else i(`BŁĄD: ${t.name} nie jest obrazem.`);c.push(...n),k()}window.moveUp=e=>{e>0&&([c[e-1],c[e]]=[c[e],c[e-1]],k())};window.moveDown=e=>{e<c.length-1&&([c[e+1],c[e]]=[c[e],c[e+1]],k())};window.removeFile=e=>{const n=c[e];if(n.selected){const t=c.length;c=c.filter(r=>!r.selected);const o=t-c.length;i(`Usunięto zaznaczone pliki: ${o}`)}else i(`Usunięto: ${n.file.name}`),c.splice(e,1);k()};async function Y(){const e=c.filter(f=>f.selected);if(e.length===0){i("BŁĄD: Brak zaznaczonych plików do przetworzenia.");return}const n=m.value.trim()||"image",t=parseInt(R.value)||1,o=P.value,r=O.checked,p=U.checked;F.checked;const a=r,l=p;if(i(`Rozpoczynanie procedury dla ${e.length} plików...`),window.electronAPI){i("Wykryto środowisko Desktop (Electron). Używam natywnego przetwarzania...");let f=e.map(s=>{let g=null;return window.electronAPI.getPathForFile&&(g=window.electronAPI.getPathForFile(s.file)),g||(g=s.file.path),g||(i(`OSTRZEŻENIE: Brak ścieżki dla pliku: ${s.file.name}. Sprawdź uprawnienia lub metodę dodawania.`),null)}).filter(s=>s!==null);if(f.length===0){i("BŁĄD: Nie udało się pobrać ścieżek plików. Operacja przerwana.");return}i(`Wysyłanie ${f.length} plików do procesu głównego...`);const d={baseName:n,startNumber:t,optCrop:a,optTrimOnly:l,optAddMargin:C.checked,optResize:A.checked,optOverwrite:N.checked};window.electronLogListenerAdded||(window.electronAPI.onLog(s=>i(s)),window.electronLogListenerAdded=!0);try{const s=await window.electronAPI.processImages(f,d);s.success?i(`SUKCES: Zapisano w katalogu: ${s.path}`):i(`BŁĄD: ${s.message}`)}catch(s){i(`BŁĄD KRYTYCZNY: ${s.message}`)}return}if(o==="local"){i("Tryb WEB (Lokalny) - start przetwarzania...");const f={baseName:n,startNumber:t,optCrop:a,optTrimOnly:l,optAddMargin:C.checked,optResize:A.checked};try{const{processFilesClientSide:d}=await Z(async()=>{const{processFilesClientSide:u}=await import("./assets/client-processor-DndueCvx.js");return{processFilesClientSide:u}},__vite__mapDeps([0,1]),import.meta.url),s=await d(e,f,u=>i(u)),g=window.URL.createObjectURL(s),y=document.createElement("a");y.href=g,y.download="processed.zip",document.body.appendChild(y),y.click(),y.remove(),i("SUKCES: Gotowe (Lokalnie).")}catch(d){i(`BŁĄD LOKALNY: ${d.message}`)}return}}
//# sourceMappingURL=tools.js.map
